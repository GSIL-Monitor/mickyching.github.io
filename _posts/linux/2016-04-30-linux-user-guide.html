---
title: Linux用户指南
author: 敬叶
categories: linux
tags: linux ubuntu
---
<div id="table-of-contents"><h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline16">系统安装</a>
<ul>
<li><a href="#orgheadline15">安装配置</a>
<ul>
<li><a href="#orgheadline8">安装软件</a></li>
<li><a href="#orgheadline14">实用配置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline31">系统管理</a>
<ul>
<li><a href="#orgheadline18">网络管理</a>
<ul>
<li><a href="#orgheadline17">基本配置</a></li>
</ul>
</li>
<li><a href="#orgheadline20">用户管理</a>
<ul>
<li><a href="#orgheadline19">用戶管理</a></li>
</ul>
</li>
<li><a href="#orgheadline28">设备管理</a>
<ul>
<li><a href="#orgheadline21">时间配置</a></li>
<li><a href="#orgheadline25">引导配置</a></li>
<li><a href="#orgheadline27">内核配置</a></li>
</ul>
</li>
<li><a href="#orgheadline30">软件管理</a>
<ul>
<li><a href="#orgheadline29">Debian/Ubuntu</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgheadline39">文件系统</a>
<ul>
<li><a href="#orgheadline38">文件系统</a>
<ul>
<li><a href="#orgheadline37">文件备份</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-2">
<h2 id="orgheadline16">系统安装</h2>
<div class="outline-text-2" id="text-orgheadline16">
</div><div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15">安装配置</h3>
<div class="outline-text-3" id="text-orgheadline15">
</div><div id="outline-container-orgheadline8" class="outline-4">
<h4 id="orgheadline8">安装软件</h4>
<div class="outline-text-4" id="text-orgheadline8">
</div><ul class="org-ul"><li><a id="orgheadline1"></a>配置软件源<br  /><div class="outline-text-5" id="text-orgheadline1">
<ul class="org-ul">
<li>/etc/apt/sources.list</li>
<li><a href="https://lug.ustc.edu.cn/wiki/mirrors/help/ubuntu">https://lug.ustc.edu.cn/wiki/mirrors/help/ubuntu</a></li>
<li><a href="https://mirrors.ustc.edu.cn/repogen/">https://mirrors.ustc.edu.cn/repogen/</a></li>
</ul>
</div></li>

<li><a id="orgheadline2"></a>google-chrome<br  /><div class="outline-text-5" id="text-orgheadline2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">&#33258;&#24102;flash&#25554;&#20214;</span>
wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
</pre>
</div>
</div></li>

<li><a id="orgheadline3"></a>fcitx<br  /><div class="outline-text-5" id="text-orgheadline3">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">&#22312; &#31995;&#32479;|&#35821;&#35328;&#25903;&#25345; &#20013;&#36873;&#25321; fcitx &#20316;&#20026;&#38190;&#30424;&#36755;&#20837;&#27861;</span>
apt-get install fcitx-googlepinyin
</pre>
</div>
</div></li>

<li><a id="orgheadline4"></a>jdk<br  /><div class="outline-text-5" id="text-orgheadline4">
<div class="org-src-container">

<pre class="src src-sh">apt install default-jdk

<span style="color: #666;"># </span><span style="color: #666;">&#37197;&#32622;&#29615;&#22659;&#21464;&#37327;</span>
<span style="color: #048;">JAVA_HOME</span>=<span style="color: #800;">"/usr/lib/jvm/default-java"</span>
</pre>
</div>
</div></li>

<li><a id="orgheadline5"></a>latex<br  /><div class="outline-text-5" id="text-orgheadline5">
<div class="org-src-container">

<pre class="src src-sh">wget https://github.com/scottkosty/install-tl-ubuntu/raw/master/install-tl-ubuntu
chmod +x install-tl-ubuntu
./install-tl-ubuntu --help              <span style="color: #666;"># </span><span style="color: #666;">show help</span>
sudo ./install-tl-ubuntu                <span style="color: #666;"># </span><span style="color: #666;">install latex</span>
</pre>
</div>
</div></li>

<li><a id="orgheadline6"></a>stardict<br  /><div class="outline-text-5" id="text-orgheadline6">
<div class="org-src-container">

<pre class="src src-sh">sudo apt-get install stardict

<span style="color: #666;"># </span><span style="color: #666;">&#23433;&#35013;&#35789;&#24211;</span>
ls *.bz2 | xargs -n 1 -I {} sudo tar -xjvf {} -C /usr/share/stardict/dic/

<span style="color: #666;"># </span><span style="color: #666;">&#38544;&#34255;&#20027;&#31383;&#21475;&#65306;&#36873;&#39033;|&#20027;&#31383;&#21475;|Options|&#38544;&#34255;&#20027;&#31383;&#21475;</span>
<span style="color: #666;"># </span><span style="color: #666;">&#25171;&#24320;&#20027;&#31383;&#21475;</span>
stardict - Lookup words
</pre>
</div>
</div></li>

<li><a id="orgheadline7"></a>virtualbox<br  /><div class="outline-text-5" id="text-orgheadline7">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">&#23558;&#29992;&#25143;&#21152;&#20837;&#21040;vboxusers&#32452;&#65292;&#20197;&#20415;usb&#35774;&#22791;&#23548;&#20837;&#21040;&#34394;&#25311;&#26426;&#20013;</span>
usermod -a -G vboxusers micky
</pre>
</div>
</div></li></ul>
</div>

<div id="outline-container-orgheadline14" class="outline-4">
<h4 id="orgheadline14">实用配置</h4>
<div class="outline-text-4" id="text-orgheadline14">
</div><ul class="org-ul"><li><a id="orgheadline9"></a>去掉桌面显示主目录下的文件<br  /><div class="outline-text-5" id="text-orgheadline9">
<p>
Ubuntu配置方法：编辑<code>~/.config/user-dirs.dirs</code>文件，直接清空即可。
</p>
</div></li>

<li><a id="orgheadline10"></a>触摸板配置<br  /><div class="outline-text-5" id="text-orgheadline10">
<pre class="example">
# /etc/X11/xorg.conf.d/70-synaptics.conf
Section "InputClass"
        Identifier "touchpad catchall"
        Driver "synaptics"
        MatchIsTouchpad "on"
        Option "TapButton1" "1"
        Option "TapButton2" "3"
        Option "TapButton3" "2"
        Option "VertEdgeScroll" "on"
        Option "VertTwoFingerScroll" "on"
        Option "HorizEdgeScroll" "on"
        Option "HorizTwoFingerScroll" "on"
        Option "CircularScrolling" "on"
        Option "CircScrollTrigger" "2"
        Option "EmulateTwoFingerMinZ" "40"
        Option "EmulateTwoFingerMinW" "8"
        Option "FingerLow" "30"
        Option "FingerHigh" "50"
        Option "MaxTapTime" "125"
        Option "VertScrollDelta" "-111"
        Option "HorizScrollDelta" "-111"
        Option "DialDelta" "-1"
</pre>
</div></li>

<li><a id="orgheadline11"></a>语言环境<br  /><div class="outline-text-5" id="text-orgheadline11">
<p>
中文环境下需要通过如下命令添加<code>zh_CN.UTF-8</code>支持：
</p>
<div class="org-src-container">

<pre class="src src-sh">sudo dpkg-reconfigure locales           <span style="color: #666;"># </span><span style="color: #666;">add zh_CN.UTF-8</span>
sudo locale-gen zh_CN.UTF-8
sudo locale
</pre>
</div>

<p>
如果没有添加中文支持，在启动文本编辑程序时可能出现如下提示而无法输入中文。
</p>
<pre class="example">
(process:3747): Gtk-WARNING **: Locale not supported by C library.
        Using the fallback 'C' locale.
</pre>

<p>
为了能够在编辑程序中使用中文输入法，需要对文件<code>/etc/environment</code>做如下设置。
</p>
<pre class="example">
LC_CTYPE="zh_CN.UTF-8"
</pre>
</div></li>

<li><a id="orgheadline12"></a>DNS配置<br  /><div class="outline-text-5" id="text-orgheadline12">
<p>
在 /etc/network/interfaces 中添加 dns-nameservers/dns-search/dns-domain 等配置
</p>
</div></li>

<li><a id="orgheadline13"></a>终端<br  /><div class="outline-text-5" id="text-orgheadline13">
<p>
Tmux是一个支持分屏的终端，可以直接通过apt-get安装：
</p>
<div class="org-src-container">

<pre class="src src-sh">sudo apt-get install tmux
</pre>
</div>

<p>
在gnome-terminal中输入tmux即可进入tmux终端。
Tmux基本概念包括：
</p>
<dl class="org-dl">
<dt>server</dt><dd>输入tmux命令开启一个服务</dd>
<dt>session</dt><dd>一个服务包含多个会话</dd>
<dt>window</dt><dd>一个会话包含多个窗口</dd>
<dt>pane</dt><dd>一个窗口包含多个面板</dd>
</dl>
</div></li></ul>
</div>
</div>
</div>


<div id="outline-container-orgheadline31" class="outline-2">
<h2 id="orgheadline31">系统管理</h2>
<div class="outline-text-2" id="text-orgheadline31">
</div><div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18">网络管理</h3>
<div class="outline-text-3" id="text-orgheadline18">
</div><div id="outline-container-orgheadline17" class="outline-4">
<h4 id="orgheadline17">基本配置</h4>
<div class="outline-text-4" id="text-orgheadline17">
<p>
基本网络接口控制可以通过<code>ifconfig</code>命令配置，但是该命令只能临时配置，持久化需要通过配置文件实现。
</p>
<div class="org-src-container">

<pre class="src src-sh">ifconfig eth0 up|down                   <span style="color: #666;"># </span><span style="color: #666;">&#24320;&#21551;/&#20851;&#38381;</span>
ifconfig eth0[:1] 192.168.2.10 [netmask 255.255.255.0] [broadcast 192.168.2.255]
ifconfig eth0 hw ether AA:BB:CC:DD:EE:FF
ifconfig eth0 mtu 1024                  <span style="color: #666;"># </span><span style="color: #666;">&#35774;&#32622;MTU</span>
ifconfig eth0 arp|-arp                  <span style="color: #666;"># </span><span style="color: #666;">&#21551;&#29992;/&#20851;&#38381;ARP&#21327;&#35758;</span>
ifconfig eth0 promisc|-promisc          <span style="color: #666;"># </span><span style="color: #666;">promisc&#34920;&#31034;&#19981;&#20250;&#20002;&#24323;&#21035;&#20154;&#30340;&#21253;</span>
ifconfig eth0 add 33ffe:3240:800:1005::2/64    <span style="color: #666;"># </span><span style="color: #666;">&#37197;&#32622;IPv6&#22320;&#22336;</span>
ifconfig eth0 del 33ffe:3240:800:1005::2/64    <span style="color: #666;"># </span><span style="color: #666;">&#21024;&#38500;IPv6&#22320;&#22336;</span>
</pre>
</div>

<p>
永久修改MTU：
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">-- CentOS / RHEL / Fedora: /etc/sysconfig/network-scripts/ifcfg-eth0</span>
<span style="color: #048;">MTU</span>=<span style="color: #800;">"1500"</span>                              <span style="color: #666;"># </span><span style="color: #666;">service network restart</span>
<span style="color: #048;">IPV6_MTU</span>=<span style="color: #800;">"1280"</span>                         <span style="color: #666;"># </span><span style="color: #666;">for IPv6</span>

<span style="color: #666;"># </span><span style="color: #666;">-- Debian / Ubuntu: /etc/network/interfaces</span>
mtu 9000                                <span style="color: #666;"># </span><span style="color: #666;">/etc/init.d/networking restart</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20">用户管理</h3>
<div class="outline-text-3" id="text-orgheadline20">
</div><div id="outline-container-orgheadline19" class="outline-4">
<h4 id="orgheadline19">用戶管理</h4>
<div class="outline-text-4" id="text-orgheadline19">
<p>
账户管理相关配置文件如下表所示。
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">配置</th>
<th scope="col" class="org-left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">/etc/passwd</td>
<td class="org-left">每个用户一行，用户基本信息</td>
</tr>

<tr>
<td class="org-left">/etc/shadow</td>
<td class="org-left">每个用户一行，包括加密密码</td>
</tr>

<tr>
<td class="org-left">/etc/group</td>
<td class="org-left">系统中的用户组</td>
</tr>

<tr>
<td class="org-left">/etc/default/useradd</td>
<td class="org-left">命令useradd默认会加入的组</td>
</tr>

<tr>
<td class="org-left">/etc/login.defs</td>
<td class="org-left">用于配置/etc/shadow</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-sh">useradd -G group user                   <span style="color: #666;"># </span><span style="color: #666;">&#23558;&#29992;&#25143;&#21152;&#20837;&#25351;&#23450;&#32452;</span>
useradd -G admins,ftp,developers user   <span style="color: #666;"># </span><span style="color: #666;">&#23558;&#29992;&#25143;&#21152;&#20837;&#22810;&#20010;&#32452;</span>
useradd -g developers user              <span style="color: #666;"># </span><span style="color: #666;">&#23558;&#29992;&#25143;&#21152;&#20837;&#22522;&#30784;&#32452;&#65292;&#19968;&#20010;&#29992;&#25143;&#21482;&#33021;&#26377;&#19968;&#20010;&#22522;&#30784;&#32452;</span>
usermod -a -G ftp user                  <span style="color: #666;"># </span><span style="color: #666;">&#23558;&#24050;&#26377;&#29992;&#25143;append&#21040;&#25351;&#23450;&#32452;</span>
usermod -g www user                     <span style="color: #666;"># </span><span style="color: #666;">&#26356;&#25442;&#29992;&#25143;&#22522;&#30784;&#32452;</span>
groupadd developers                     <span style="color: #666;"># </span><span style="color: #666;">&#28155;&#21152;&#19968;&#20010;&#26032;&#30340;&#29992;&#25143;&#32452;</span>
id user                                 <span style="color: #666;"># </span><span style="color: #666;">&#26597;&#30475;&#19968;&#20010;&#29992;&#25143;id&#20449;&#24687;&#20197;&#21450;&#22312;&#21738;&#20123;&#32452;</span>
</pre>
</div>

<p>
将用户加入sudo组之后，配置<code>/etc/sudoers</code>添加如下行即可使用sudo命令：
</p>
<pre class="example">
# using command add user to sudo group: usermod -a -G sudo &lt;username&gt;
# Allow members of group sudo to execute any command
%sudo   ALL=(ALL:ALL) ALL
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28">设备管理</h3>
<div class="outline-text-3" id="text-orgheadline28">
</div><div id="outline-container-orgheadline21" class="outline-4">
<h4 id="orgheadline21">时间配置</h4>
<div class="outline-text-4" id="text-orgheadline21">
<p>
debian下的时间通常比windows快8个小时，这在双系统上很容易测试出来。通过如下命令可以让其和windows时间相同：
</p>
<div class="org-src-container">

<pre class="src src-sh">hwclock -w --localtime
</pre>
</div>
</div>
</div>
<div id="outline-container-orgheadline25" class="outline-4">
<h4 id="orgheadline25">引导配置</h4>
<div class="outline-text-4" id="text-orgheadline25">
</div><ul class="org-ul"><li><a id="orgheadline22"></a>通过USB Live CD安装grub<br  /><div class="outline-text-5" id="text-orgheadline22">
<div class="org-src-container">

<pre class="src src-sh">sudo mount /dev/sda5 /mnt
sudo mount --bind /dev /mnt/dev
sudo mount --bind /sys /mnt/sys
sudo mount --bind /proc /mnt/proc
sudo mount /dev/sdaX /mnt/boot          <span style="color: #666;"># </span><span style="color: #666;">only if you separate boot partition</span>
sudo chroot /mnt
sudo grub-install --root-directory=/mnt /dev/sda
</pre>
</div>
</div></li>
<li><a id="orgheadline23"></a>处理隐藏GRUB<br  /><div class="outline-text-5" id="text-orgheadline23">
<p>
如果执行<code>update-grub2</code>更新grub动作的时候能看到如下提示信息，则说明GRUB被隐藏了，启动的时候也看不到选择界面。
</p>

<blockquote>
<p>
Generating grub configuration file &#x2026;
Warning: Setting GRUB_TIMEOUT to a non-zero value
when GRUB_HIDDEN_TIMEOUT is set is no longer supported.
</p>
</blockquote>

<p>
处理办法是编辑<code>/etc/default/grub</code>注释掉<code>GRUB_HIDDEN_TIMEOUT</code>行。
</p>
</div></li>
<li><a id="orgheadline24"></a>通过GRUB rescue修复grub<br  /><div class="outline-text-5" id="text-orgheadline24">
<div class="org-src-container">

<pre class="src src-sh">grub&gt; set <span style="color: #048;">pager</span>=1

grub&gt; ls
(hd0) (hd0,msdos2) (hd0,msdos1)

grub&gt; ls (hd0,1)/
lost+found/ bin/ boot/ cdrom/ dev/ etc/ home/  lib/
lib64/ media/ mnt/ opt/ proc/ root/ run/ sbin/
srv/ sys/ tmp/ usr/ var/ vmlinuz vmlinuz.old
initrd.img initrd.img.old

grub&gt; cat (hd0,1)/etc/issue
Ubuntu 14.04 LTS \n \l

grub&gt; set <span style="color: #048;">root</span>=(hd0,1)
grub&gt; linux /boot/vmlinuz-3.13.0-29-generic <span style="color: #048;">root</span>=/dev/sda1
grub&gt; initrd /boot/initrd.img-3.13.0-29-generic
grub&gt; boot

<span style="color: #666;"># </span><span style="color: #666;">&#26377;&#20123;Linux&#31995;&#32479;&#24050;&#32463;&#26377;&#20102;&#36229;&#38142;&#25509;&#65292;&#21487;&#20197;&#37319;&#29992;&#26356;&#31616;&#21333;&#30340;&#20889;&#27861;</span>
grub&gt; set <span style="color: #048;">root</span>=(hd0,1)
grub&gt; linux /vmlinuz <span style="color: #048;">root</span>=/dev/sda1
grub&gt; initrd /initrd.img
grub&gt; boot
</pre>
</div>

<p>
如果GRUB rescue shell和通常的不一样，可以载入模块normal.mod和linux.mod。
</p>
<div class="org-src-container">

<pre class="src src-sh">grub rescue&gt; set <span style="color: #048;">prefix</span>=(hd0,1)/boot/grub
grub rescue&gt; set <span style="color: #048;">root</span>=(hd0,1)
grub rescue&gt; insmod normal
grub rescue&gt; normal
grub rescue&gt; insmod linux
grub rescue&gt; linux /boot/vmlinuz-3.13.0-29-generic <span style="color: #048;">root</span>=/dev/sda1
grub rescue&gt; initrd /boot/initrd.img-3.13.0-29-generic
grub rescue&gt; boot
</pre>
</div>

<p>
最好在启动之后永久性的修复一下。
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">update-grub</span>
Generating grub configuration file ...
...
<span style="color: #800;">done</span>
<span style="color: #666;"># </span><span style="color: #666;">grub-install /dev/sda</span>
Installing for i386-pc platform.
Installation finished. No error reported.
</pre>
</div>
</div></li></ul>
</div>

<div id="outline-container-orgheadline27" class="outline-4">
<h4 id="orgheadline27">内核配置</h4>
<div class="outline-text-4" id="text-orgheadline27">
</div><ul class="org-ul"><li><a id="orgheadline26"></a>更新initramfs<br  /><div class="outline-text-5" id="text-orgheadline26">
<p>
有时候删除内核模块之后，重启还是能看到已删除的模块载入到系统。这可能性是从<code>initramfs</code>中载入的，更新一下即可。
</p>
<div class="org-src-container">

<pre class="src src-sh">update-initramfs -c -k 2.6.18-1-686
</pre>
</div>
<dl class="org-dl">
<dt>-c</dt><dd>表示新创建一个<code>initramfs</code></dd>
<dt>-k</dt><dd>指定内核版本，可以用<code>uname -r</code>获取</dd>
</dl>
</div></li></ul>
</div>
</div>

<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30">软件管理</h3>
<div class="outline-text-3" id="text-orgheadline30">
</div><div id="outline-container-orgheadline29" class="outline-4">
<h4 id="orgheadline29">Debian/Ubuntu</h4>
<div class="outline-text-4" id="text-orgheadline29">
<p>
软件包管理主要需要熟悉的命令：<code>dpkg</code>、<code>apt-cache</code>、<code>apt-get</code>、<code>apt-file</code>等。
</p>

<p>
查询软件包状态信息
</p>
<div class="org-src-container">

<pre class="src src-sh">dpkg -l | head
<span style="color: #048;">Desired</span>=Unknown/Install/Remove/Purge/Hold
| <span style="color: #048;">Status</span>=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,Err: <span style="color: #048;">uppercase</span>=bad)
||/ Name                      Version                         Architecture Description
+++-=========================-===============================-============-============
ii  account-plugin-aim        3.8.6-0ubuntu9.2                amd64        Messaging ac
ii  account-plugin-facebook   0.11+14.04.20140409.1-0ubuntu2  all          GNOME Contro
ii  account-plugin-flickr     0.11+14.04.20140409.1-0ubuntu2  all          GNOME Contro
ii  account-plugin-google     0.11+14.04.20140409.1-0ubuntu2  all          GNOME Contro
ii  account-plugin-jabber     3.8.6-0ubuntu9.2                amd64        Messaging ac
</pre>
</div>

<p>
对安装包的操作：
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">ref: dpkg man page</span>
dpkg --listfiles &lt;package&gt;              <span style="color: #666;"># </span><span style="color: #666;">&#26597;&#35810;&#23646;&#20110;&#36719;&#20214;&#30340;&#25991;&#20214;</span>
dpkg -s &lt;package&gt;                       <span style="color: #666;"># </span><span style="color: #666;">&#26597;&#35810;&#36719;&#20214;&#35814;&#32454;&#20449;&#24687;</span>
dpkg -S &lt;package&gt;                       <span style="color: #666;"># </span><span style="color: #666;">&#20174;&#23433;&#35013;&#21253;&#20013;&#26597;&#35810;&#25991;&#20214;&#21517;</span>
</pre>
</div>

<p>
Ubuntu下还需要熟悉如下命令：
</p>
<div class="org-src-container">

<pre class="src src-sh">apt-cache search                        <span style="color: #666;"># </span><span style="color: #666;">&#25628;&#32034;&#36719;&#20214;&#21253;</span>
apt-cache show                          <span style="color: #666;"># </span><span style="color: #666;">&#33719;&#21462;&#36719;&#20214;&#21253;&#30456;&#20851;&#20449;&#24687;</span>
apt-get remove
apt-get remove --purge
apt-get build-dep                       <span style="color: #666;"># </span><span style="color: #666;">&#23433;&#35013;&#32534;&#35793;&#29615;&#22659;</span>
</pre>
</div>

<p>
PPA叫Personal Package Archives，添加好PPA源之后在<code>/etc/apt/sources.list.d/</code>目录下就能看到对应的列表。
</p>
<div class="org-src-container">

<pre class="src src-sh">sudo add-apt-repository ppa:user/name   <span style="color: #666;"># </span><span style="color: #666;">&#28155;&#21152;PPA</span>
sudo add-apt-repository -r ppa:username <span style="color: #666;"># </span><span style="color: #666;">&#21024;&#38500;PPA</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline39" class="outline-2">
<h2 id="orgheadline39">文件系统</h2>
<div class="outline-text-2" id="text-orgheadline39">
</div><div id="outline-container-orgheadline38" class="outline-3">
<h3 id="orgheadline38">文件系统</h3>
<div class="outline-text-3" id="text-orgheadline38">
</div><ul class="org-ul"><li><a id="orgheadline32"></a>修改磁盘卷标<br  /><div class="outline-text-5" id="text-orgheadline32">
<div class="org-src-container">

<pre class="src src-sh">sudo e2label DEV LABEL                  <span style="color: #666;"># </span><span style="color: #666;">ext3/ext4</span>
sudo btrfs filesystem label DEV LABEL   <span style="color: #666;"># </span><span style="color: #666;">btrfs</span>
sudo ntfslabel DEV LABEL                <span style="color: #666;"># </span><span style="color: #666;">ntfs</span>
</pre>
</div>
</div></li>
<li><a id="orgheadline33"></a>启动NFS服务<br  /><div class="outline-text-5" id="text-orgheadline33">
<p>
安装NFS服务工具：
</p>
<div class="org-src-container">

<pre class="src src-sh">sudo apt-get install nfs-kernel-server
</pre>
</div>

<p>
编辑<code>/etc/exports</code>添加如下一行。
</p>
<div class="org-src-container">

<pre class="src src-sh">/home/micky/dev/nfs   *(ro,sync,no_root_squash)
</pre>
</div>

<p>
重启NFS服务。
</p>
<div class="org-src-container">

<pre class="src src-sh">sudo service nfs-kernel-server restart
</pre>
</div>

<p>
客户端只需要挂载即可使用：
</p>
<div class="org-src-container">

<pre class="src src-sh">mount -t nfs -o <span style="color: #048;">proto</span>=tcp,<span style="color: #048;">port</span>=2049,nolock 192.168.1.67:/home/micky/dev/nfs /mnt/
</pre>
</div>
</div></li>

<li><a id="orgheadline34"></a>启动NFS服务 on Centos<br  /><div class="outline-text-5" id="text-orgheadline34">
<pre class="example">
yum -y install nfs-utils rpcbind

vi /etc/exports
/share     *(rw,sync,no_root_squash)

service rpcbind start
service nfs start

on client:
mount -t nfs -o proto=tcp,port=2049,nolock 192.168.153.59:/data /home/nfs59
</pre>
</div></li>

<li><a id="orgheadline35"></a>自动挂载USB设备<br  /><div class="outline-text-5" id="text-orgheadline35">
<p>
创建文件<code>/etc/udev/rules.d/87-usb-automount.rules</code>
</p>

<div class="org-src-container">

<pre class="src src-sh">KERNEL!=<span style="color: #800;">"sd[a-z][0-9]"</span>, <span style="color: #048;">GOTO</span>=<span style="color: #800;">"exit_automount"</span>
<span style="color: #666;"># </span><span style="color: #666;">Import FS info</span>
IMPORT{program}=<span style="color: #800;">"/sbin/blkid -o udev -p %N"</span>
<span style="color: #666;"># </span><span style="color: #666;">Get a label if present, otherwise specify one</span>
ENV{ID_FS_LABEL}!=<span style="color: #800;">""</span>, ENV{dir_name}=<span style="color: #800;">"%E{ID_FS_LABEL}"</span>
ENV{ID_FS_LABEL}==<span style="color: #800;">""</span>, ENV{dir_name}=<span style="color: #800;">"Disk-%k"</span>
<span style="color: #666;"># </span><span style="color: #666;">Global mount options</span>
<span style="color: #048;">ACTION</span>==<span style="color: #800;">"add"</span>, ENV{mount_options}=<span style="color: #800;">"relatime"</span>
<span style="color: #666;"># </span><span style="color: #666;">Filesystem-specific mount options</span>
<span style="color: #048;">ACTION</span>==<span style="color: #800;">"add"</span>, ENV{ID_FS_TYPE}==<span style="color: #800;">"vfat|ntfs"</span>, ENV{mount_options}=<span style="color: #800;">"$env{mount_options},utf8,gid=100,umask=002"</span>
<span style="color: #666;"># </span><span style="color: #666;">Mount the device</span>
<span style="color: #048;">ACTION</span>==<span style="color: #800;">"add"</span>, <span style="color: #048;">RUN</span>+=<span style="color: #800;">"/bin/mkdir -p /media/%E{dir_name}"</span>, <span style="color: #048;">RUN</span>+=<span style="color: #800;">"/bin/mount -o $env{mount_options} /dev/%k /media/%E{dir_name}"</span>
<span style="color: #666;"># </span><span style="color: #666;">Clean up after removal</span>
<span style="color: #048;">ACTION</span>==<span style="color: #800;">"remove"</span>, ENV{dir_name}!=<span style="color: #800;">""</span>, <span style="color: #048;">RUN</span>+=<span style="color: #800;">"/bin/umount /dev/%k"</span>
<span style="color: #048;">ACTION</span>==<span style="color: #800;">"remove"</span>, ENV{dir_name}!=<span style="color: #800;">""</span>, <span style="color: #048;">RUN</span>+=<span style="color: #800;">"/bin/umount -l /media/%E{dir_name}"</span>, <span style="color: #048;">RUN</span>+=<span style="color: #800;">"/bin/rmdir /media/%E{dir_name}"</span>
<span style="color: #666;"># </span><span style="color: #666;">Exit</span>
<span style="color: #048;">LABEL</span>=<span style="color: #800;">"exit_automount"</span>
</pre>
</div>

<p>
更新配置：
</p>
<div class="org-src-container">

<pre class="src src-sh">udevadm control --reload-rules
</pre>
</div>
</div></li>

<div id="outline-container-orgheadline37" class="outline-4">
<h4 id="orgheadline37">文件备份</h4>
<div class="outline-text-4" id="text-orgheadline37">
</div><ul class="org-ul"><li><a id="orgheadline36"></a>rsync<br  /><div class="outline-text-5" id="text-orgheadline36">
<p>
1，rsync可以再中断传输之后恢复传输
2，rsync只传输源文件和目标文件之间不一致的部分
3，rsync可以执行完整或增量备份
4，可以使用基于ssh等方式传输文件
5，可以保持原有文件的所有属性信息
</p>

<div class="org-src-container">

<pre class="src src-sh">Local:  rsync [OPTION...] SRC... [DEST]

Access via remote shell:
  Pull: rsync [OPTION...] [USER@]HOST:SRC... [DEST]
  Push: rsync [OPTION...] SRC... [USER@]HOST:DEST

Access via rsync daemon:
  Pull: rsync [OPTION...] [USER@]HOST::SRC... [DEST]
        rsync [OPTION...] rsync://[USER@]HOST[:PORT]/SRC... [DEST]
  Push: rsync [OPTION...] SRC... [USER@]HOST::DEST
        rsync [OPTION...] SRC... rsync://[USER@]HOST[:PORT]/DEST

Usages with just one SRC arg and no DEST arg will list the source files instead of copying.
</pre>
</div>

<p>
常用选项
</p>
<dl class="org-dl">
<dt>-a, &#x2013;archive</dt><dd>归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD</dd>
<dt>-r, &#x2013;recursive</dt><dd>对子目录以递归模式处理</dd>
<dt>-l, &#x2013;links</dt><dd>保留软链接</dd>
<dt>-p, &#x2013;perms</dt><dd>保持文件权限</dd>
<dt>-t, &#x2013;times</dt><dd>保持文件时间信息</dd>
<dt>-g, &#x2013;group</dt><dd>保持文件属组信息</dd>
<dt>-o, &#x2013;owner</dt><dd>保持文件属主信息</dd>
<dt>-D, &#x2013;devices</dt><dd>保持设备文件信息</dd>

<dt>-c, &#x2013;checksum</dt><dd>打开校验开关，强制对文件传输进行校验</dd>
<dt>-v, &#x2013;verbose</dt><dd>详细模式输出</dd>
<dt>-H, &#x2013;hard-links</dt><dd>保留硬链接</dd>
<dt>-E, &#x2013;executability</dt><dd>保留可执行权限</dd>
<dt>&#x2013;progress</dt><dd>显示进度</dd>
<dt>&#x2013;log-file=FILE</dt><dd>指定日志文件</dd>

<dt>-n, &#x2013;dry-run</dt><dd>显示哪些文件将被传输</dd>
<dt>-u, &#x2013;update</dt><dd>只进行更新，跳过比源头更新的文件</dd>
<dt>-b, &#x2013;backup</dt><dd>创建备份，被覆盖的文件会被重命名为~filename
<dl class="org-dl">
<dt>&#x2013;suffix=SUFFIX</dt><dd>定义备份文件前缀</dd>
<dt>&#x2013;backup-dir=DIR</dt><dd>指定备份目录</dd>
</dl></dd>

<dt>-w, &#x2013;whole-file</dt><dd>完全复制，不进行增量检测</dd>
<dt>-x, &#x2013;one-file-system</dt><dd>不跨越文件系统边界</dd>
<dt>-R, &#x2013;relative</dt><dd>使用相对路径信息</dd>
<dt>-z, &#x2013;compress</dt><dd>在传输时对备份文件进行压缩处理</dd>
<dt>-S, &#x2013;sparse</dt><dd>对稀疏文件进行特殊处理以节省DST的空间</dd>
<dt>-q, &#x2013;quiet</dt><dd>精简输出模式</dd>
<dt>&#x2013;existing</dt><dd>只备份DST存在的文件，忽略新建文件</dd>
<dt>&#x2013;delete</dt><dd>删除DST有而SRC没有的文件</dd>
<dt>&#x2013;delete-excluded</dt><dd>删除DST中被指定排除的文件</dd>
<dt>&#x2013;delete-after</dt><dd>传输结束之后再删除</dd>
<dt>&#x2013;ignore-errors</dt><dd>当删除出现错误时，忽略错误并继续删除</dd>
<dt>&#x2013;force</dt><dd>强制删除非空的目录</dd>
<dt>&#x2013;bwlimit=KBPS</dt><dd>限制IO带宽</dd>
</dl>

<p>
符号链接选项说明：
</p>
<dl class="org-dl">
<dt>&#x2013;copy-links</dt><dd>将所有链接变成普通文件</dd>
<dt>&#x2013;links &#x2013;copy-unsafe-links</dt><dd>复制安全链接，不安全链接变为普通文件</dd>
<dt>&#x2013;links &#x2013;safe-links</dt><dd>复制安全链接，跳过不安全链接</dd>
<dt>&#x2013;links</dt><dd>复制所有符号链接</dd>
<dt>&#x2013;copy-unsafe-links</dt><dd>不安全链接变为普通文件，跳过安全链接</dd>
<dt>-K, &#x2013;keep-dirlinks</dt><dd>保留目录符号链接</dd>
<dt>-k, &#x2013;copy-dirlinks</dt><dd>替换目录符合链接为普通目录</dd>
</dl>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #666;"># </span><span style="color: #666;">&#20840;&#37327;&#21516;&#27493;&#21629;&#20196;</span>
rsync -acvKHE --progress --log-file=rsync.log SRC DST
<span style="color: #666;"># </span><span style="color: #666;">&#22686;&#37327;&#21516;&#27493;&#21629;&#20196;</span>
rsync -acvKHEu --progress --log-file=rsync.log SRC DST
<span style="color: #666;"># </span><span style="color: #666;">&#26174;&#31034;&#21516;&#27493;&#21015;&#34920;</span>
rsync -acvKHEn SRC DST
</pre>
</div>
</div></li></ul>
</div>
</div>
</div>
